<div id="app">
  <div id="question">
    ถาม {{ question }}
  </div>
  <div id="answer">
    ตอบ {{ answer }}
  </div>
  <button v-on:click="poop">ปุ๊บ</button>
  <button v-on:click="pup">ปั๊บ</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
<script>
var app = new Vue({
  el: '#app',
  data: {
    DIRECT: { 'poop': 'ปุ๊บ', 'pup': 'ปั๊บ' },
    INVERT: { 'poop': 'ปั๊บ', 'pup': 'ปุ๊บ' },
    TIMER: 600,
    RATE: 30,
    question: '...',
    answer: '...',
    memo: [],
    id: null,
    timer: 0
  },
  methods: {
    poop: function() {
      this.memo.push('poop');
      this.update();
    },
    pup: function() {
      this.memo.push('pup');
      this.update();
    },
    update: function() {
      this.question = this.memo.map(x => this.DIRECT[x]).join(' ');
      this.answer = '...';
      this.start_countdown();
    },
    start_countdown: function() {
      clearTimeout(this.id);
      this.timer = this.TIMER;
      this.loop_countdown();
    },
    loop_countdown: function() {
      if (this.timer > 0) {
        this.id = setTimeout(() => {
          this.loop_countdown()
          this.timer -= this.RATE;
        }, this.RATE);
      } else {
        this.ask();
        this.timer = this.TIMER;
      }
    },
    ask: function() {
      this.answer = this.memo.map(x => this.INVERT[x]).join(' ');
      this.memo = [];
    }
  }
});
</script>
